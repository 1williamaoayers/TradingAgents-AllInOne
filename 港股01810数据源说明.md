# 港股01810（小米集团-W）分析使用的数据源

## 📊 数据源总览

当你在前端输入港股代码 **01810** 开始分析时，系统会调用多个分析师Agent并行获取不同维度的数据。以下是各个维度使用的数据源：

---

## 1️⃣ 技术面分析 (Technical Analysis)

### 数据来源：AKShare
- **工具包**: `akshare`
- **具体接口**: `stock_hk_hist()` - 港股历史数据
- **数据字段**:
  - 日期、开盘价、收盘价、最高价、最低价
  - 成交量、成交额
  - 涨跌幅

### 计算指标：
- **移动平均线**: MA5, MA10, MA20, MA60
- **MACD**: DIF、DEA、MACD柱状图
- **RSI**: 相对强弱指标(14日)
- **布林带**: 上轨、中轨、下轨

### 分析维度：
- 价格趋势（短期/中期/长期）
- 支撑位与压力位
- 成交量配合分析
- 技术形态识别

---

## 2️⃣ 基本面分析 (Fundamentals Analysis)

### 数据来源：AKShare
- **接口**: `stock_hk_spot_em()` - 港股实时行情
- **接口**: 财务数据接口（营收、利润等）

### 核心财务数据：
- **盈利能力**:
  - 营业收入、同比增长率
  - 归母净利润、同比增长率
  - 净利率、毛利率
  - ROE（净资产收益率）
  - ROA（总资产收益率）

- **每股指标**:
  - 基本每股收益(EPS)
  - 滚动每股收益(EPS_TTM)
  - 每股净资产(BPS)
  - 每股经营现金流

- **偿债能力**:
  - 资产负债率
  - 流动比率

### 估值分析：
- **市盈率(PE)**: 基于滚动EPS计算
- **市净率(PB)**: 基于每股净资产计算
- **PEG比率**: PE/净利润增长率
- **合理价位区间**: 基于PE、PB多种估值方法计算

---

## 3️⃣ 新闻分析 (News Analysis)

### 🔥 统一新闻聚合工具 - 并行融合策略

代码位置: `src/tradingagents/tools/unified_news_tool.py` L899-1060

#### 核心机制：6个数据源并行调用

**重要**：所有数据源是**并行获取**，不是降级策略！

```
并行调用 6个数据源
    ├─ 数据源1: 东方财富个股新闻
    ├─ 数据源2: AKShare多源快讯 (7个子源)
    ├─ 数据源3: Serper实时搜索
    ├─ 数据源4: Alpha Vantage (港股跳过)
    ├─ 数据源5: RSS新闻源 (7个子源)
    └─ 数据源6: MongoDB数据库缓存
    
    ↓ 收集所有成功结果
    ↓ 智能去重（NewsDeduplicator）
    ↓ 融合报告
```

#### 数据源详情

**1. 东方财富个股新闻**
- API: `stock_news_em(symbol='01810')`
- 特点: 个股专属，相关性最高

**2. AKShare多源快讯（7个子源）**
- API: `get_multi_source_news(limit_per_source=5)`
- 子源: 财联社、东财、新浪、同花顺、富途、财新、财经早餐

**3. Serper实时搜索**
- API: Google搜索API
- 搜索词: "01810 小米集团 新闻 财报 分析"
- 时间: 过去1天

**4. Alpha Vantage**
- 状态: 港股自动跳过（仅支持美股）

**5. RSS新闻源（7个子源）**
- 子源: 金十数据、财联社、格隆汇、华尔街见闻、Google News×2、Yahoo

**6. MongoDB数据库**
- 集合: `stock_news`
- 查询: 精确匹配symbol + 全文检索title/content

#### 新闻处理特性
- ✅ **并行获取**: 所有源同时调用，提高效率
- ✅ **智能去重**: 跨数据源去重，基于标题和日期
- ✅ **容错机制**: 单个源失败不影响其他源
- ✅ **质量保证**: 记录成功数据源和新闻数量

---

## 4️⃣ 市场情绪分析 (Sentiment Analysis)

### 数据来源：

#### A. 在线搜索（Serper API）
- **平台覆盖**:
  - 东方财富股吧
  - 雪球社区
  - 财经新闻网站
  - 社交媒体讨论

#### B. 分析维度：
- **整体情绪评级**: 积极/中性/消极
- **情绪得分**: 0-1之间的量化分数
- **置信度**: 基于数据样本量

#### C. 关注要点：
- 公司回购动作
- 资金流向（南向资金、港股通）
- 大手交易
- 市场热点话题
- 投资者讨论焦点

---

## 🎯 数据聚合流程（以01810为例）

```
用户输入: 01810
    ↓
识别股票类型: 港股
    ↓
并行启动4个分析师Agent
    ↓
┌─────────────┬─────────────┬─────────────┬─────────────┐
│技术面分析师  │基本面分析师  │新闻分析师    │情绪分析师    │
├─────────────┼─────────────┼─────────────┼─────────────┤
│AKShare      │AKShare      │MongoDB      │Serper API   │
│历史数据接口  │财务数据接口  │+ AKShare    │+ 社交媒体    │
│             │             │+ Serper     │             │
└─────────────┴─────────────┴─────────────┴─────────────┘
    ↓
数据汇总到Judge Agent（裁判分析师）
    ↓
综合分析 → 投资建议
```

---

## 📦 主要数据源总结

| 数据维度 | 主要数据源 | 备用数据源 | 数据更新频率 |
|---------|-----------|-----------|------------|
| **技术面** | AKShare | - | 实时（日线数据） |
| **基本面** | AKShare | - | 定期（季报/年报） |
| **新闻** | MongoDB数据库 | AKShare + Serper | 实时聚合 |
| **情绪** | Serper API | 社交媒体API | 实时搜索 |

---

## 🔍 数据源并行融合策略

### 新闻获取机制：并行调用，而非降级

**所有数据源同时调用**：
- 东方财富、AKShare多源、Serper、RSS、MongoDB、Playwright
- 每个源独立运行，失败不影响其他源
- 最后融合所有成功结果

### 优势：
- ✅ **并行高效**：所有源同时获取，速度快
- ✅ **容错能力强**：单个源失败不影响整体
- ✅ **智能去重**：跨数据源去重，避免重复
- ✅ **覆盖面广**：6个一级源 + 14个子源 = 20个数据源
- ✅ **质量保证**：记录成功源数量和新闻条数

---

## 📝 关键文件位置

- **统一新闻工具**: `src/tradingagents/tools/unified_news_tool.py`
- **技术分析工具**: AKShare集成
- **基本面分析工具**: AKShare财务数据接口
- **情绪分析工具**: Serper搜索API集成

---

## ⚠️ 数据源依赖说明

1. **必需配置**:
   - MongoDB连接（用于新闻存储）
   - 可选但推荐：Serper API Key（用于在线新闻搜索）

2. **数据完整性**:
   - 技术面：依赖AKShare，数据稳定性高
   - 基本面：依赖AKShare财务接口
   - 新闻面：多数据源保障
   - 情绪面：需要Serper API配置

---

**生成时间**: 2026-01-23
**适用版本**: TradingAgents-AllInOne
